Custom middleware (auth, error handling)